{% extends "./layout.html" %}

{% block content %}
    <section class="row">
    {% if users.length === 0 %}
    <section class="container">
      <p class="alert alert-warning">No users left.</p>
    </section>
    {% endif %}

    {% for user in users %}
      <div class="col-md-3">
        <div class="panel panel-default" style="min-height: 300px">

        <!-- panel head -->
          <div class="panel-heading">
            <p>{{ user.name }}</p>
            <form action="/users/{{ user.id }}?_method=DELETE" method="POST">
              <button class="btn btn-danger btn-sm">Delete</button>
            </form>
          </div>

        <!-- panel body start -->
        <div class="panel-body">
          <ul class="list-unstyled">
            <li>
              <form action="/users/{{ user.id }}/awards" method="POST">
                <button class="btn btn-primary btn-sm">Create an award</button>
              </form>
            </li>


          <!-- awards section  -->
          {% if awards %}
          <li>
            <ul style="margin: 10px 0; padding: 0 0 0 15px">
              {% for award in awards %}
                {% if award.userId == user.id %}
                <li>
                  {{ award.content }}
                  <form action="/users/{{ user.id }}/awards/{{ award.id }}?_method=DELETE" method="POST" class="form-group">
                    <button class="btn btn-warning btn-xs">Delete Award</button>
                  </form>
                </li>
                {% endif %}
              {% endfor %}
            </ul>
          </li>
          {% endif %}


          <!-- mentor section -->
          {% if user.mentorId %}
          <li style="margin: 10px 0">
            <p class="label label-default">Mentored by: {{ user.mentor.name }} </p>
          </li>
          <li>
            <form action="/users/{{ user.id }}?_method=PUT" method="POST" class="form-group">
              <input type="hidden" name="mentorId" value="{{ user.mentorId }}">
              <button class="btn btn-warning">Remove Mentor</button>
            </form>
          </li>
          {% else %}
          <li>
            <form action="/users/{{ user.id }}?_method=PUT" method="POST" class="well">
              <div class="form-group">
                <select class="form-control" name="id">
                {% for mentor in users %}
                  {% if mentor.name !== user.name %}
                  {% if mentor.awardCount > 1 %}
                  <option value="{{ mentor.id }}">{{ mentor.name }}</option>
                  {% endif %}
                  {% endif %}
                {% endfor %}
                </select>
              </div>
              <button class="btn btn-primary btn-sm">Set Mentor</button>
            </form>
          </li>
          {% endif %}
          </ul>
        </div>
        </div>
      </div>
    {% endfor %}
    </section>
{% endblock %}
